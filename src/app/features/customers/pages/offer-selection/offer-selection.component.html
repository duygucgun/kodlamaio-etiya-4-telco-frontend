<div class="e-offer-selection-container">
  <app-navbar></app-navbar>
  <div class="container-fluid">
    <div class="row">
      <div class="d-flex justify-content-end p-0">
        <app-user-info></app-user-info>
      </div>
    </div>
  </div>
  <app-main-layout [layoutTitle]="'Offer Selection'">
    <div class="e-offer-selection-content">
      <div class="row">
        <div class="col-12 col-xl-8 e-offer-selection-center">
          <app-tab-menu class="e-tab">
            <div one>
              <div class="offer-title mb-3">Catalog Selection</div>
              <form [formGroup]="searchCatalogForm">
                <div class="e-dropdown">
                  <select etiyaInput="dark" formControlName="selectedId">
                    <option selected value="">Select</option>
                    <option
                      *ngFor="let catalog of catalogList"
                      value="{{ catalog.id }}"
                    >
                      {{ catalog.name }}
                    </option>
                  </select>
                </div>
                <div class="row">
                  <div class="col-12 col-xl-6">
                    <div class="row m-2 e-offer-selection-center">
                      <div class="col-12 col-lg-5 p-0">
                        <label class="e-offer-label" for="prodOfferId"
                          >Prod Offer ID
                        </label>
                      </div>
                      <div class="col-12 col-lg-7 p-0">
                        <input
                          type="text"
                          class="offer-input"
                          etiyaInput="dark"
                          formControlName="prodOfferId"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-xl-6">
                    <div class="row e-offer-selection-center">
                      <div class="col-12 col-lg-5 p-0">
                        <label class="e-offer-label" for="prodOfferName"
                          >Prod Offer Name
                        </label>
                      </div>
                      <div class="col-12 col-lg-7 p-0">
                        <input
                          type="text"
                          class="offer-input"
                          etiyaInput="dark"
                          formControlName="prodOfferName"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </form>
              <div class="col-12 d-flex justify-content-end">
                <button
                  class="e-offer-button"
                  etiyaButton="clear"
                  (click)="searchCatalog()"
                >
                  Search
                </button>
              </div>
              <div class="e-offer-table">
                <app-table-scroll class="e-table">
                  <thead>
                    <tr class="table-title">
                      <th class="col-5">Prod Offer ID</th>
                      <th class="col-7">Prod Offer Name</th>
                    </tr>
                  </thead>
                  <tbody class="table-body">
                    <tr
                      *ngFor="let catalogOffer of catalogOffersList"
                      (click)="addBasket(catalogOffer)"
                      [ngClass]="{ selected: isSelected(catalogOffer) }"
                    >
                      <td class="col-5">{{ catalogOffer.id }}</td>
                      <td class="col-7">
                        <span *ngIf="isSelected(catalogOffer)"
                          >{{ getOfferCount(catalogOffer) }}x</span
                        >
                        {{ catalogOffer.name }}
                      </td>
                    </tr>
                  </tbody>
                </app-table-scroll>
                <small
                  *ngIf="catalogOffersList?.length == 0"
                  class="p-error block ng-invalid ng-dirty"
                  style="margin-left: 250px; margin-top: -30px"
                >
                  The product is not found in Catalog.
                </small>
              </div>
            </div>

            <div two>
              <div class="offer-title mb-3">Campaign Selection</div>
              <form [formGroup]="searchCampaignForm">
                <div class="e-dropdown">
                  <select etiyaInput="dark" formControlName="selectedId">
                    <option selected disabled hidden value="">Select</option>
                    <option *ngFor="let campaign of campaignList">
                      {{ campaign.name }}
                    </option>
                  </select>
                </div>
                <div class="row">
                  <div class="col-12 col-xl-6">
                    <div class="row m-2 e-offer-selection-center">
                      <div class="col-12 col-lg-5 p-0">
                        <label class="e-offer-label" for="prodOfferId"
                          >Campaign ID
                        </label>
                      </div>
                      <div class="col-12 col-lg-7 p-0">
                        <input
                          type="text"
                          class="offer-input"
                          etiyaInput="dark"
                          formControlName="campaignId"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-xl-6">
                    <div class="row e-offer-selection-center">
                      <div class="col-12 col-lg-5 p-0">
                        <label class="e-offer-label" for="prodOfferName"
                          >Campaign Name
                        </label>
                      </div>
                      <div class="col-12 col-lg-7 p-0">
                        <input
                          type="text"
                          class="offer-input"
                          etiyaInput="dark"
                          formControlName="campaignName"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </form>
              <div class="col-12 d-flex justify-content-end">
                <button
                  class="e-offer-button"
                  etiyaButton="clear"
                  (click)="searchCampaign()"
                >
                  Search
                </button>
              </div>
              <div class="e-offer-table">
                <app-table-scroll class="e-table">
                  <thead>
                    <tr class="table-title">
                      <th class="col-2">Campaign ID</th>
                      <th class="col-2">Prod Offer ID</th>
                      <th class="col-8">Prod Offer Name</th>
                    </tr>
                  </thead>
                  <tbody class="table-body">
                    <tr
                      *ngFor="let campaignOffer of campaignOffersList"
                      (click)="addBasket(campaignOffer)"
                      [ngClass]="{ selected: isSelected(campaignOffer) }"
                    >
                      <td class="col-2">{{ campaignOffer.type.id }}</td>
                      <td class="col-2">{{ campaignOffer.id }}</td>
                      <td class="col-8">
                        <span *ngIf="isSelected(campaignOffer)"
                          >{{ getOfferCount(campaignOffer) }}x</span
                        >
                        {{ campaignOffer.name }}
                      </td>
                    </tr>
                  </tbody>
                </app-table-scroll>
                <small
                  *ngIf="campaignOffersList?.length == 0"
                  class="p-error block ng-invalid ng-dirty"
                  style="margin-left: 250px; margin-top: -30px"
                >
                  The product is not found in Campaign.
                </small>
              </div>
            </div>
          </app-tab-menu>
        </div>
        <div class="col-12 col-xl-4 e-offer-selection-center">
          <app-basket></app-basket>
        </div>
      </div>
      <div class="row e-buttons">
        <div
          class="col-8 d-flex justify-content-end align-items-center add-basket-button"
        >
          <button
            etiyaButton="accordion-body"
            (click)="saveBasket()"
            [disabled]="offerList.length == 0"
          >
            Add Basket
          </button>
        </div>
        <div
          class="col-4 d-flex justify-content-end align-items-center next-button"
        >
          <button
            etiyaButton="clear"
            [disabled]="!itemsInBasket"
            [routerLink]="
              '/dashboard/customers/' +
              selectedCustomerId +
              '/configuration-product/' +
              billingAccountId
            "
          >
            NEXT
          </button>
        </div>
      </div>
    </div>
  </app-main-layout>
</div>
